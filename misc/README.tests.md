# icsconvcsv.py　動作確認スクリプト tests.sh 解説

by 松元隆二

初版公開 2026-1-22

最終更新:2026-1-26

icsconvcsv.py　動作確認スクリプト tests.sh 解説になります。
Linux/macOS専用。Windowsでは動作しません。

## ディレクトリ ICS/*.ics のサンプルのファイル名について。

ICSファイル名の頭はICSを生成したアプリ名です。

- gaはGaroon
- ouはOutlook(Web)
- oucはOutlook(Classic)

の略です。

ICSファイル名の後ろで下記は出力範囲の指定。指定ない場合は、詳細をすべ
て出力したファイルです。

Outlook(Web):
 - 自分の予定が入っている時間を閲覧可能: *-limit1.ics
 - タイトルと場所を閲覧可能: *-limit2.ics

Outlook(classic):
 - 空き時間情報のみ: *-limit1.ics
 - 詳細情報の一部: *-limit2.ics

# 使い方

コマンドnkfを内部で使っています。未インストールなら導入してください。

icsconvcsvの設定などを実施したあと、以下のコマンドを実行してください。

```:bash
% bash tests.sh
```

検査内容が「MEMO:文章」で表示されます。失敗した場合のみ差分が表いされ
ますが、失敗した場合でも、「MEMO:失敗で正常」と記載ある場合は問題あり
ません。

すべて正常に終わった場合は「正常終了しました。」と表示されます。

## 0.1: プログラム作者向けメモ:ICSファイルを追加する時

カレンダーソフトから出力されたICSファイルを追加する場合、下記の点に注
意をお願いします。

### パスワードやURL

除去もしくは、ダミーのパスワード/URLに修正する。

Teamsの会議開催時に自動的にメモ欄に挿入されるパスワードについては正規
表現で取り除いていますが、テスト用にpublicにICSファイルを公開する場合
は、パスワードおよびURLをランダム化してください。

### メールアドレス

除去もしくは、ダミーのメールアドレスに修正する。

Outlook(classic)はヘッダを

```:text
X-WR-CALNAME:Fukuoka Taro
X-OWNER;CN="Fukuoka Taro":mailto:fukuoka.taro@example.jp
```
それ以外のアドレスは
「熊本太郎/kumamoto.taro@example.jp」
「佐賀太郎/saga.taro@example.jp」
等にする

## 0.2: スクリプトtests.shでテストが行われないオプション
オプション「--enable-file-exist-test」のテストは行ってません。

このオプションは出力先のCSVファイルがすでに存在する場合は、上書きの確
認を求めてきます。次に、ICSファイルの日付が古い場合は、警告もしくは、
プログラムを停止します。

手順：

適当なICSファイルを準備し、「calendar.ics」という名前で置く。

touchコマンドでファイルの日付を新しくする。出力先のCSV「tmp.csv」がす
でにあったら消す。

```:text
% touch  calendar.ics
% rm tmp.csv
```

2回実行して、2回目に上書きするか確認してくるかを調べる。

```:text
% python3 icsconvcsv.py --enable-file-exist-test all calendar.ics tmp.csv
% python3 icsconvcsv.py --enable-file-exist-test all calendar.ics tmp.csv
```

このような感じの質問があります。Yesと答えてください。

```:text
WARNING: CSVファイル 「tmp.csv」 がすでに存在します。
WARNING: 上書きしますか?
WARNING: [Y]es/[N]o? >>
```

次に、touchコマンドでファイルの日付を古くする。日付は4桁年2桁月2桁日です
```:text
% touch -d 20251231 calendar.ics
% rm tmp.csv
```

コマンドを実行し、

```:text
% python3 icsconvcsv.py --enable-file-exist-test all calendar.ics tmp.csv
```
以下のエラーになるか確認する
```:text
ERROR: 入力元のICSファイル「calendar.ics」の日付が古いです。
ERROR: xyz時間前のファイルです。最新のファイルをダウンロードしてください。
ERROR: 最新の場合はファイル名が間違えてないか確認ください。
```
以上です。

# 1: 各種ICSサンプル(バグ対策)

本節のサンプルはバグ対策を行ってる例になります。

# 1.1: ga1.ics
EXDATEの書式の問題で例外を送出するバグ

入力例:

```text:
時間指定なしの繰り返しスケジュール

-TEST:90:7月の月曜繰り返し20日除外/終日スケジュール(時刻なし)
2026年7月6日(月)から2026年7月27日(月)。20日(月)除外
終日スケジュール(時刻なし)
```

問題点:

Garoonの終日日程の繰り返しスケジュールRRULEで除外日EXDATEを指定した場
合、pythonのvobjectライブラリで

```:text
parseエラー:
EXDATE:20260720
  → 発生箇所:vobject.readOne()
```

以下のどちらかの修正が必要。EXDATEに型指定なしでデータを渡すと、時間あ
りデータとみなされるみたい。

```:text
EXDATE;VALUE=DATE:20260720
 → 型を明示的に指定
 → 本対応を実施。関数PreSetup.bug_fix_rrule()参照
```

```:text
EXDATE:20251215T000000
 → 時間を追記する。
```

## 1.2: ou1.ics
日付情報でnaiveとawareが混在するバグ

出力CSV: ou1.csv

カレンダー入力内容はga1.icsと同じ。

出力されるICSの抜粋(ou1.ics)

```:text
RRULE:FREQ=WEEKLY;UNTIL=20260726T150000Z;INTERVAL=1;BYDAY=MO;WKST=SU
EXDATE;TZID=Tokyo Standard Time:20260720T000000
DTSTART;VALUE=DATE:20260706
DTEND;VALUE=DATE:20260707
```

Outlook(New)の終日スケジュール(時刻なし)のVEVENTのRRULEで除外日EXDATE
を指定した場合、上記のように出力されるが、pythonのvobjectライブラリで
下記箇所がエラー

```:test
EXDATE;TZID=Tokyo Standard Time:20260720T000000
   -> 発生箇所: component.getrruleset(addRDate=True)
```

上記のエラーはDTSTART/DTENDにTimeZone情報が無い(naive)が、EXDATEデータには
TIMEZONEがある(aware)ため、比較できない。

本件はOutlook(Web)のバグと考えている。TimeZoneデータがあり、TZ.guess()
がTZを返す場合のみ、以下の修正を行う。関数 Main.ics2csv() 参照

```:text
component.dtstart.value = TZ.native2aware(dtstart)
component.dtend.value = TZ.native2aware(dtend)
```

## 1.3: ou2.ics, ouc2.ics, ga2.ics
Garoonが生成するICSファイルで、ESCが適切に行われない例。

ICSの仕様で文章中の「,」と「;」はバックスラッシュでエスケープする必要
ありますがGaroonはエスケープを行いません。

icsconvcsv.pyでは特に対応はしてないため、差分として現れる。

CSVはou2.csvのみ。

```:text
-TEST:60:記号テスト,切れる
テスト前,テスト後
2026年5月22日 9時30分-10時00分

-TEST:61:記号テスト;切れる
テスト前;テスト後
2026年5月22日 10時00分-10時30分

-TEST:62:記号テスト\切れる
テスト前\テスト後
2026年5月22日 10時30分-11時00分

-TEST:63:記号テスト\,切れる
テスト前\,テスト後
2026年5月22日 13時00分-13時30分

-TEST:64:記号テスト\;切れる
テスト前\;テスト後
2026年5月22日 13時30分-14時00分

-TEST:65:記号テスト\\切れる
テスト前\\テスト後
2026年5月22日 14時00分-14時30分
```

## 1.4: ou3.ics, ou1.ics(再掲)

TimeZoneを誤って指定すると、スケジュールの計算にミスをする例。

Outlook(Web)では、終日スケジュール(時刻なし)の繰返しスケジュールを作成
した場合、繰返し回数を指定するRRULEで終端日を示すUNTILに時刻情報あり
TimeZoneがUTCになっている。

本来はUNTILは日付情報のみ(時刻なし)とすべき。

そのため、本来は時刻情報が無かった終日スケジュール(時刻なし)を時刻を考
慮した処理が必要となる。

スケジュール入力例(ou3.ics)および前述のou1.ics

```:text
-TEST:10:火曜繰返し/終日/修正なし
毎週2026年4月28日(火)-6月2日(火)
除外日なし。
```

出力されるICSの抜粋(ou3.ics)

```:text
RRULE:FREQ=WEEKLY;UNTIL=20260601T150000Z;INTERVAL=1;BYDAY=TU;WKST=SU
DTSTART;VALUE=DATE:20260428
DTEND;VALUE=DATE:20260429
```

上記の「UNTIL=20260601T150000」は、日本時間(JST/UTC+9)では6月2日0:00だ
が、アメリカ東部時間(EDT/UTC-4/サマータイム)では6月1日20:00。そのため、
TimeZoneを誤って引数で指定(-TUS/Eastern)すると、繰返し回数をあやまり、
最終日の6月2日が出力されなくなる。

UNTILは本来ならTZや時刻なしの「UNTIL=20260602」が良いと考える。

次に、EXDATEの処理を誤る事例を挙げる。

出力されるICSの抜粋(ou1.ics)/再掲

```:text
RRULE:FREQ=WEEKLY;UNTIL=20260726T150000Z;INTERVAL=1;BYDAY=MO;WKST=SU
EXDATE;TZID=Tokyo Standard Time:20260720T000000
DTSTART;VALUE=DATE:20260706
DTEND;VALUE=DATE:20260707
```

EXDATEが時刻情報とTimeZoneがあるため、ou3.icsと同等の理由により、
TimeZoneを誤って引数で指定(-TUS/Eastern)すると、EXDATEの計算をミスし、
7月20日が除外対象とならない。

## 1.5: ouc4.ics, ouc4-baduid.ics

繰返しスケジュール(RRULE)の一部修正(RECURRENCE-ID)を行い、参照元のRRULEを喪失させた例。

RRULE側のUIDを修正し、参照元を喪失させてます。

- ouc4.ics:UIDが正常な例

- ouc4-baduid.ics:UIDを意図的に壊した例

以下のようなスケジュールを作成すると

```:text
-TEST:91:7月の火曜繰り返し一部日時修正
2026年7月7日(火)から2026年7月28日(火)。
終日スケジュール(時刻なし)
21日(火)を22日(水)へ修正
```

```:text
-TEST:92:7月の火曜繰り返し一部時刻修正
2026年7月7日(火)から2026年7月28日(火)。
12:00-13:00
21日(火)を13:00-14:00へ修正
```

以下のようなICSファイルが生成されます。(抜粋)

```:text
BEGIN:VEVENT
CLASS:PUBLIC
CREATED:20260127T003625Z
DESCRIPTION:2026年7月7日(火)から2026年7月28日(火)。\n終日ス
	ケジュール(時刻なし)\n21日(火)を22日(水)へ修正\n
DTEND;VALUE=DATE:20260708
DTSTART;VALUE=DATE:20260707
RRULE:FREQ=WEEKLY;COUNT=4;BYDAY=TU
SUMMARY;LANGUAGE=ja:TEST:91:7月の火曜繰り返し一部日時修正
TRANSP:TRANSPARENT
UID:040000008200E00074C5B7101A82E00800000000D9D2AEF7248FDC01000000000000000
	010000000FCC24558F542FC4B91C8007AF5E2B4BB
END:VEVENT

BEGIN:VEVENT
DTEND;VALUE=DATE:20260723
DTSTAMP:20260127T003904Z
DTSTART;VALUE=DATE:20260722
RECURRENCE-ID;VALUE=DATE:20260721
UID:040000008200E00074C5B7101A82E00800000000D9D2AEF7248FDC01000000000000000
	010000000FCC24558F542FC4B91C8007AF5E2B4BB
END:VEVENT
```

```:text
BEGIN:VEVENT
DESCRIPTION:2026年7月7日(火)から2026年7月28日(火)。\n12:00-13:00
	\n21日(火)を13:00-14:00へ修正\n
DTEND;TZID="Tokyo Standard Time":20260707T130000
DTSTART;TZID="Tokyo Standard Time":20260707T120000
RRULE:FREQ=WEEKLY;COUNT=4;BYDAY=TU
SUMMARY;LANGUAGE=ja:TEST:92:7月の火曜繰り返し一部時刻修正
UID:040000008200E00074C5B7101A82E0080000000023935F20258FDC01000000000000000
	0100000003426F9DE26794D419A0197EBC7316A5E
END:VEVENT

BEGIN:VEVENT
DTEND:20260721T050000Z
DTSTART:20260721T040000Z
RECURRENCE-ID:20260721T030000Z
UID:040000008200E00074C5B7101A82E0080000000023935F20258FDC01000000000000000
	0100000003426F9DE26794D419A0197EBC7316A5E
END:VEVENT
```

繰返しスケジュールRRULEの日付や時刻の修正をすると、RECURRENCE-IDが含ま
れるVEVENTが生成されます。このVEVENTにはSUMMARYおよびDESCRIPTIONが含ま
れません。ただしSUMMARYおよびDESCRIPTIONの修正を行った場合は、修正内容
が含まれます。

そのため、ICSファイルから一部を取り出した時に、RRULEが含まれるVEVENTを
誤って消すと、RECURRENCE-IDが含まれるVEVENTの復元に失敗します。

本例ではRRULEが含まれるVEBENTのUIDを修正しています。UIDに"BAD"を追加して
います。そのため、参照元のVEVENTが喪失します。この場合「SUMMARY」が
"(REFERENCE DATA DOES NOT EXIST)"という表記になります。

コマンドicsconvscvの設計で「SUMMARY」は必須としてますが、「DESCRIPTION」は
必須としてないため、「DESCRIPTION」は"(N/A)"という表記になります。

また、本来はRECURRENCE-IDで無効になるべきスケジュールがそのまま残ります。

# 2: 各種ICSサンプル(出力確認)

本節のサンプルは期待した出力が行われてるかの確認になります。

## 2.1: ou10.ics, ouc10.ics, ou10-free.ics, ou10-us.ics

Outlookで使える属性の調査。Outlookでスケジュールを入力するときに設定可能な
各種属性のテストになります。

Outlook(Web, classic)/Outlook(Web無償版)/Outlook(Web無償版/アメリカ東時間)

出力はCSV-Simple形式のみ調査。

ou10.csv / ouc10.csv /　ou10-free.csv / ou10-us.csv

2025/9/28の9:00から30分刻みで入力する。Web無償版は2025/10/5の9:00から
30分刻みで入力する。


```
9:00-
-TEST:30:仮の予定
-TEST:31:他の場所で作業中
-TEST:32:空き時間
-TEST:33:不在
-TEST:34:予定あり(default)

12:00-
-TEST:40:色付けのテスト(オレンジ)
-TEST:41:色付けのテスト(黄)
-TEST:42:色付けのテスト(紫)
-TEST:43:色付けのテスト(青)
-TEST:44:色付けのテスト(赤)
-TEST:45:色付けのテスト(緑)

16:00-
-TEST:50:アイコン(サッカーボール)
-TEST:51:アイコン(カプセル錠剤)
-TEST:52:アイコン(時計)
```

補足: TEST:3xの入力は、ICSに出力されます。 TEST:4xの入力は
OutlookClassicのICSにのみ出力されます。TEST:5xの入力はICSには出力されません。

## 2.2: ou11.ics, ouc11.ics, ga11.ics

日付をいろいろ複雑に入力した例。

Outlook(Web, classic)/Garoon

出力はCSV-Garoon形式のみ調査。

ou11.csv, ouc11.csv, ga11.csv, ga11-org.csv

ga11-org.csv: Garoonが生成したCSVをUTF-8にしたもの。

本文修正と記載あるのは、「本文修正なし」を「本文修正あり」に修正する。


```:text
-TEST:01:時間指定なしスケジュール/1日
終日:2026年4月29日-4月29日

-TEST:02:時間指定なしスケジュール/2日
終日:2026年4月30日-5月1日

-TEST:03:日またぎスケジュール
2026年5月8日23:00-5月9日23:00

-TEST:04:月またぎスケジュール/3日
2026年4月30日23:00-5月2日23:00

-TEST:05:開始時間と終了時刻が同じ(1)  / 改訂コンマを全角へ。
2026年5月14日 0時0分開始、0時0分終了

-TEST:06:開始時間と終了時刻が同じ(2)  / 改訂コンマを全角へ。
2026年5月14日 9時30分開始、 9時30分終了

-TEST:07:開始時間と終了時刻を0:00に明示/終日  / 改訂コンマを全角へ。
2026年5月15日 0時00分開始、5月16日 0時0分終了

-TEST:08:開始時間のみで終了時間無し  (※Outlookでは開始と終了を同じ時間にする。)
2026年5月21日 8時30分開始、終了時間なし。

# 設定不可
#-TEST:09:終了時間のみで開始時間なし
# 2026年5月22日 開始時間なし。終了時刻17時15分。

-TEST:10:火曜繰返し/終日/修正なし
毎週2026年4月28日(火)-6月2日(火)
除外日なし。

-TEST:11:月曜繰返し/終日/各種修正 (※Garoonは終日日程の修正はできないので新規でいれる)
毎週2026年4月27日(月)-6月1日(月)
除外日5月4日
5月25日(月)を 5月29日(金)の13:00-14:00へ修正
本文修正5月18日(月)
「本文修正なし」

-TEST:12:水曜繰返し終日/時間修正
毎週2026年4月29日(水)-5月27日(水)
4月29日を4月28日へ修正
5月6日を5月7日へ修正
5月27日を6月3日へ修正

-TEST:13:日曜繰返し(1)
毎週2026/4/26(日)から5月31日(日)の毎週日曜日8:00-8:15
除外日なし。

-TEST:14:日曜繰返し(2) (※Garoonは終日から時間日程への修正はできないので新規でいれる)
毎週2026/4/26(日)から5月31日(日)の毎週日曜日8:30-9:00
5月3日を除外日。10日の本文修正。17日の時間修正(9:30-10:00)
5月24日(日)を5月26日(火)終日に修正
「本文修正なし」

-TEST:15:日曜繰返し(3)
毎週2026/4/26(日)から5月31日(日)の毎週日曜日10:30-11:30
24日の日を25日へ修正
31日の日を6日1日へ修正

```

## 2.3: ou12.ics, ou12-limit2.ics, ouc12.ics, ouc12-limit2.ics

職場の業務記録記載用の拡張業務番号。

Outlook(Web, classic)および出力制限。

出力はCSV-Garoon形式のみ調査。

```:text
-TEST:70:拡張業務番号%9900
-----------

可
行頭改行
2025年12月27日 9時00分-9時30分
-----------

-TEST:71:拡張業務番号%9901 (※コピペ後空白いれる)
-----------

可
行頭空白1文字※TABは受け付けてくれない
2025年12月27日 9時30分-10時00分
-----------

(記入ミスで３０分とんでる)

-TEST:72:拡張業務番号%9902
-----------

可
行頭空白2文字※TABは受け付けてくれない
2025年12月27日 10時30分-11時00分
-----------

-TEST:73:拡張業務番号(タイトル欄優先)%9903
-----------
9904
可
メモ欄とタイトルの業務番号相違。タイトル欄優先
2025年12月27日 11時00分-11時30分
-----------

-TEST:74:拡張業務番号(一行めに関係ない記述)%9905
-----------
2025年12月27日 11時30分-12時00分
-----------

-TEST:75:拡張業務番号(未記入)%9906
-----------
-----------
2025年12月27日 13時00分-13時30分

-TEST:76:拡張業務番号(禁則文字N/A)%9907
-----------
(N/A)
-----------
2025年12月27日 13時30分-14時00分

-TEST:77:拡張業務番号(別記法)g9608
-----------

可
行頭空白2文字※TABは受け付けてくれない
2025年12月27日 14時00分-14時30分
-----------

-TEST:78:拡張業務番号(別記法タイトル欄優先)g9609
-----------
９６１０
可
メモ欄とタイトルの業務番号相違。タイトル欄優先。メモ欄全角
2025年12月27日 14時30分-15時00分
-----------

-TEST:79:拡張業務番号(別記法/行頭全角空白)g9611
-----------

可
行頭全角空白1文字
2025年12月27日 15時00分-15時30分
-----------
```

## 2.4: ou13.ics, ouc13.ics, ga13.ics

SUMMARYの分割テスト

出力はCSV-Garoon形式のみ調査。

```:text
-出張:TEST:80:入力時に分割なし
2026年4月5日 9時00分-9時30分
OutlookおよびGaroon双方で入力時に分割しない。

-会議:TEST:81:入力時に分割あり
2026年4月5日 9時30分-10時00分
Garoon入力時は分割

-移動:TEST:82:入力時に分割なし
2026年4月5日 10時00分-10時30分
OutlookおよびGaroon双方で入力時に分割しない。

-来訪:TEST:83:入力時に分割あり
2026年4月5日 10時30分-11時00分
Garoon入力時は分割

-来訪,会議:TEST:84:分割できない例
2026年4月5日 11時00分-11時30分
OutlookおよびGaroon双方で入力時に分割しない。
使えない記号「,」が入っているため分割できない。
```

## 2.5: ou14.ics, ouc14.ics, ga14.ics, ou14-us.ics
時刻の表示の確認。スクリプト内で考えられるすべての組み合わせを試しています。

出力はCSV-Garoon形式のみ調査。

現地時間でいれる。ou14-usはアメリカ東海岸。

```:text
-TEST:100:0:00-1:25
2026年4月11日0:00-1:25

-TEST:101:1:30-2:00
2026年4月11日1:30-2:00

-TEST:102:0:00-12:00
2026年4月11日0:00-12:00

-TEST:103:11:55-23:55
2026年4月11日11:55-23:55

-TEST:104:12:00-24:00
2026年4月11日12:00-2026年4月12日0:00

-TEST:105:12:00-25:15
2026年4月11日12:00-2026年4月12日1:15

-TEST:106:終日スケジュール(時刻なし)/1日
終日:2026年4月12日-4月12日

-TEST:107:終日スケジュール(時刻なし)/2日
終日:2026年4月12日-4月13日

-TEST:108:終日スケジュール(時刻あり)/1日
2026年4月12日0:00-4月13日0:00

-TEST:109:終日スケジュール(時刻あり)/2日
2026年4月12日0:00-4月14日0:00
```

## 2.6: ou15-us.ics
TimeZone関連のテスト

入力時の作業メモ:
```:text
アメリカ東部時間(EDT): UTC-5, サーマータイムUTC-4.

日本時間(JST)との差は通常時はJST-14, サーマータイム時はJST-13.

サマータイムの切り替え日は年によって違うので注意。

- 通常→サマータイム: 2026年3月8日2:00-3:00の間が無い

- サマータイム→通常: 2025年11月2日1:00-2:00の間が2回

サマータイムの切り替え日に、EDTで終日スケジュールで時刻ありの24時間の
終日スケジュールを入力してもTimeZoneをJSTにするオプション「-TAsia/Tokyo」
を指定すると23時間になったり、25時間になったりします。
```

以下すべてのデータはOutlookのTimeZoneをアメリカ東部時間に変更して
入力してください。

タイトルがJSTになってるのもEDTで入力ください。タイトルがJSTのはEDTから
JSTに変換時に切りの良い時間になります。


```:text
-TEST:120:EDT-終日スケジュール(時刻なし)/1日/通常
終日:2026年3月1日-3月1日

-TEST:121:EDT-終日スケジュール(時刻なし)/2日/通常
終日:2026年3月1日-3月2日

-TEST:122:EDT-終日スケジュール(時刻あり)/1日/通常
2026年3月1日0:00-3月2日0:00

-TEST:123:EDT-終日スケジュール(時刻あり)/2日/通常
2026年3月1日0:00-3月3日0:00

-TEST:124:EDT-終日スケジュール(時刻なし)/1日/サマータイム
終日:2026年3月11日-3月11日

-TEST:125:EDT-終日スケジュール(時刻なし)/2日/サマータイム
終日:2026年3月11日-3月12日

-TEST:126:EDT-終日スケジュール(時刻あり)/1日/サマータイム
2026年3月11日0:00-3月12日0:00

-TEST:127:EDT-終日スケジュール(時刻あり)/2日/サマータイム
2026年3月11日0:00-3月13日0:00

-TEST:130:EDT-終日スケジュール(時刻なし)/1日/サマータイム→通常
終日:2025年11月2日-11月2日

-TEST:131:EDT-終日スケジュール(時刻なし)/2日/サマータイム→通常
終日:2025年11月2日-11月3日

-TEST:132:EDT-終日スケジュール(時刻あり)/1日/サマータイム→通常
2025年11月2日0:00-11月3日0:00

-TEST:133:EDT-終日スケジュール(時刻あり)/2日/サマータイム→通常
2025年11月2日0:00-11月4日0:00

-TEST:134:EDT-終日スケジュール(時刻なし)/1日/通常→サマータイム
終日:2026年3月8日-3月8日

-TEST:135:EDT-終日スケジュール(時刻なし)/2日/通常→サマータイム
終日:2026年3月8日-3月9日

-TEST:136:EDT-終日スケジュール(時刻あり)/1日/通常→サマータイム
2026年3月8日0:00-3月9日0:00

-TEST:137:EDT-終日スケジュール(時刻あり)/2日/通常→サマータイム
2026年3月8日0:00-3月10日0:00

-TEST:140:EDT-サマータイム→通常
2025年11月2日0:30-11月2日2:30 (3時間)(1:00-2:00の間が2回)

-TEST:141:EDT-通常→サマータイム
2026年3月8日1:30-3月8日3:30 (1時間)(2:00-3:00の間が無い)

-TEST:142:JST-終日スケジュール(時刻あり)/1日/通常
2026年2月28日10:00-3月1日10:00

-TEST:143:JST-終日スケジュール(時刻あり)/2日/通常
2026年2月28日10:00-3月2日10:00

-TEST:144:JST-終日スケジュール(時刻あり)/1日/サマータイム
2026年3月10日11:00-3月11日11:00

-TEST:145:JST-終日スケジュール(時刻あり)/2日/サマータイム
2026年3月10日11:00-3月12日11:00

-TEST:146:JST-終日スケジュール(時刻あり)/1日/サマータイム→通常
2025年11月1日11:00-11月2日10:00

-TEST:147:JST-終日スケジュール(時刻あり)/2日/サマータイム→通常
2025年11月1日11:00-11月3日10:00

-TEST:148:JST-終日スケジュール(時刻あり)/1日/通常→サマータイム
2026年3月7日10:00-3月8日11:00

-TEST:149:JST-終日スケジュール(時刻あり)/2日/通常→サマータイム
2026年3月7日10:00-3月9日11:00
```

## 2.7: ou16.ics, ouc16.ics
Teams会議およびRECURRENCE_ID命令関連

以下のテストを行っています。

- RECURRENCE_ID処理を一切しない。
- RECURRENCE_ID処理で上書きされたイベントを(Hidden: )を表示するしない。
- Teamsの会議インフォメーションを消す消さない
- メモ欄(description)の4行目以降を消す消さない

本文修正と記載あるのは、「本文修正なし」を「本文修正あり」に修正する。

※実際のICSファイルはパスワードが入ってるため、DESCRIPTIONはすでに加工
してます。本プログラムで触ってないX-ALT-DESCは完全に削除してます。

```:text
※Office365 Outlookから入力。
-TEST:20:Teams会議:Office365から無償Outlookへ
毎週2026年4月2日(木)から2026年4月30日(木) 13:00-13:15
9日の本文修正。16日の時間修正13:15-13:30。23日の会議キャンセル
参加者に無償Outlook追加
「本文修正なし」

※無償Outlookから入力。
-TEST:21:Teams会議:無償OutlookからOffice365へ
毎週2026年4月2日(木)から2026年4月30日(木) 13:30-13:45
9日の本文修正。16日の時間修正13:45-14:00。23日の会議キャンセル
参加者にOffice365追加
「本文修正なし」
```

## 2.8: ouc17-limit2.ics
RDATEを使う例。Outlookclassicが生成するICSファイルで「詳細情報の一部」
を指定すると出現する場合がある。

```:text
-TEST:12:水曜繰返し終日/時間修正
毎週2026年4月29日(水)-5月27日(水)
4月29日を4月28日へ修正
5月6日を5月7日へ修正
5月27日を6月3日へ修正

-TEST:14:日曜繰返し(2) (※Garoonは終日から時間日程への修正はできないので新規でいれる)
毎週2026/4/26(日)から5月31日(日)の毎週日曜日8:30-9:00
5月3日を除外日。10日の本文修正。17日の時間修正(9:30-10:00)
5月24日(日)を5月26日(火)終日に修正
「本文修正なし」

-TEST:15:日曜繰返し(3)
毎週2026/4/26(日)から5月31日(日)の毎週日曜日10:30-11:30
24日の日を25日へ修正
31日の日を6日1日へ修正
```

# 3: TODO: 今後実装すべき各種ICSサンプル

- RDATEのテスト例が少ないため、他のカレンダーソフトでRDATEを出力するの
  がないか探す。

- CSVの出力形式「Outlook Classic」の調査

- Outlookでメモ欄をHTMLにしたときの挙動。

以上です。
